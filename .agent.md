# Project Guide for Developers

## Project Overview

This is a **WordPress site** built using the **Roots Bedrock** framework, which provides a modern WordPress stack with improved development tools and project structure. The site appears to be focused on media activism and includes a handbook section.

### Key Technologies
- **Framework**: Roots Bedrock (WordPress boilerplate)
- **Language**: PHP (>= 7.1)
- **Dependency Management**: Composer
- **Environment Management**: Dotenv (.env files)
- **Code Standards**: PSR-2 (enforced via PHP_CodeSniffer)
- **Build Tools**: WP-CLI

## Project Structure

### Root Directory
- `composer.json` - Main dependency management and project configuration
- `wp-cli.yml` - WP-CLI configuration (sets web root and document root)
- `phpcs.xml` - PHP CodeSniffer configuration for PSR-2 standards
- `.env` - Environment variables (not tracked in git)

### Configuration (`config/`)
- `application.php` - Main WordPress configuration
- `environments/development.php` - Development-specific overrides
- `environments/staging.php` - Staging environment configuration

### Web Root (`web/`)
- `wp-config.php` - WordPress entry point (delegates to Bedrock config)
- `index.php` - Main site entry point
- `app/` - WordPress content directory (replaces wp-content)
- `wp/` - WordPress core files (managed by Composer, not tracked)
- `handbook/` - Static documentation site for "Media Activist's Handbook"

### WordPress Content (`web/app/`)
- `mu-plugins/` - Must-use plugins (always active)
- `plugins/` - Regular plugins (managed by Composer)
- `themes/` - WordPress themes
- `uploads/` - Media uploads
- `languages/` - Translation files

## Important Files and Directories

### Must-Use Plugins (`web/app/mu-plugins/`)
- `bedrock-autoloader.php` - Enables regular plugins to work as mu-plugins
- `0-worker.php` - ManageWP Worker plugin loader
- `health-check-troubleshooting-mode.php` - WordPress troubleshooting tools
- `disallow-indexing.php` - Prevents search engine indexing
- `register-theme-directory.php` - Theme directory registration

### Active Themes
- `blaskan/` - Parent theme (managed via Composer)
- `blaskan-child/` - Child theme with customizations
- `qi/` - Alternative theme available

### Key Configuration Features
- **Security**: SSL forced, file editing disabled, secure passwords with bcrypt
- **Performance**: Jetpack integration, caching configurations
- **Development**: Debug settings per environment
- **GraphQL**: JWT authentication configured
- **Analytics**: Google Analytics integration in child theme

## Development Best Practices

### Environment Management
- Use `.env` files for environment-specific configuration
- Never commit `.env` files to version control
- Set `WP_ENV` to `development`, `staging`, or `production`
- Development environment enables debugging and allows file modifications

### Code Standards
- Follow PSR-2 coding standards
- Run `composer test` to check code standards with phpcs
- Exclude WordPress core (`web/wp`) and vendor files from linting

### Plugin Management
- Use Composer to manage plugins via wpackagist.org
- Add plugins to `composer.json` as `wpackagist-plugin/plugin-name`
- Avoid installing plugins through WordPress admin in production
- Use mu-plugins for critical functionality that must always be active

### Theme Development
- Use child themes for customizations
- Parent theme is managed via Composer
- Enqueue styles and scripts properly in `functions.php`
- Follow WordPress coding standards for theme development

### Security Considerations
- File editing is disabled in admin (`DISALLOW_FILE_EDIT`)
- File modifications disabled in production (`DISALLOW_FILE_MODS`)
- SSL is forced for admin area
- Automatic updates are disabled (managed via Composer)
- Jetpack IP allowlist configured

### Performance Optimizations
- Composer autoloader optimization enabled
- WordPress object caching considerations
- Static asset optimization via themes
- CDN integration available (Cloudflare configured)

## Deployment Workflow

### Local Development
1. Clone repository
2. Run `composer install`
3. Copy `.env.example` to `.env` and configure
4. Set `WP_ENV=development`
5. Configure database credentials
6. Set document root to `web/` directory

### Staging/Production
1. Set `WP_ENV=staging` or `WP_ENV=production`
2. Disable debug settings
3. Enable file modification restrictions
4. Configure proper SSL certificates
5. Set up proper caching mechanisms

## Common Commands

### Composer
- `composer install` - Install dependencies
- `composer update` - Update dependencies
- `composer test` - Run code standards check

### WP-CLI
- `wp --path=web/wp` - Run WP-CLI commands
- Document root is automatically set to `web/` via `wp-cli.yml`

## Plugin Inventory

The site includes numerous plugins for:
- **SEO**: Yoast WordPress SEO
- **Security**: Wordfence, Loginizer
- **Performance**: LiteSpeed Cache, WP Optimize, Jetpack Boost
- **Content**: Contact Form 7, Jetpack, ActivityPub
- **Analytics**: Google Site Kit
- **Development**: Health Check, WordPress Importer

## Special Features

### Custom Post Types
- `advert` - Custom post type for AdSense management with Gutenberg blocks

### Analytics Integration
- Google Analytics (G-CZNQG5YM3Z) integrated in child theme
- Post view counting functionality implemented

### Handbook Section
- Static HTML documentation site at `web/handbook/`
- Separate from WordPress installation
- Uses Bootstrap and FontAwesome
- Focused on media activism content

## Troubleshooting

### Common Issues
- Ensure `web/` is set as document root, not project root
- Check `.env` file configuration for database connectivity
- Verify file permissions for `web/app/uploads/`
- Use Health Check plugin for WordPress troubleshooting

### Debug Mode
- Set `WP_ENV=development` in `.env`
- Debug settings are automatically enabled in development environment
- Check `config/environments/development.php` for debug configuration

### Cache Issues
- Troubleshooting mode suspends cache addition
- Clear object cache if using persistent caching
- Check Jetpack and LiteSpeed cache configurations

## Git Workflow

### Ignored Files
- WordPress core (`web/wp/`)
- Vendor dependencies (`vendor/`)
- Environment files (`.env*`)
- Uploads (`web/app/uploads/*`)
- Installed plugins (`web/app/plugins/*`)
- Log files (`*.log`)

### Tracked Files
- Configuration files
- Custom themes and mu-plugins
- Composer configuration
- Documentation and handbook content